{% set month_number = (((engine.data["total_t"] + engine.data["delta_t"]) % 25920) // 2160) %}
{% set month_names = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"] %}
{% set month = month_names[month_number] %}
{% set irradiance = engine.data["weather"]["irradiance"] %}
{% set windspeed = engine.data["weather"]["windspeed"] %}
{% set discharge = engine.data["weather"]["river_discharge"] %}
{% extends "base.jinja" %}
{% block title %}
    Dashboard
{% endblock title %}
{% block content %}
    <div class="flex-row huge title">
        Dashboard
        <div class="pine info_icon_container"
             onclick="document.getElementById('info_popup').classList.remove('hidden');">{{ wikiImage() }}</div>
    </div>
    <div id="info_popup" class="popup hidden green">
        <div class="flex-row margin-small align-items-center">
            <div class="large txt_center flex-grow-1">Help : Home</div>
            <div onclick="document.getElementById('info_popup').classList.add('hidden');"
                 class="cross pine margin-small"
                 style="width:39px">Ã—</div>
        </div>
        <div class="txt_center margin medium">
            <p>
                This is the home page of your account. Here you will find the current weather information and the 
                in-game time of the year. Ongoing or planned construction and research projects as well as ongoing 
                shipments will also show on the home page{% if "network" in user.advancements %} and,
                if you are not part of a Network, you will find a priorritization list for generation and consumption{% endif %}.
            </p>
        </div>
    </div>

    <div class="info_message medium margin padding">
        <i class="fa fa-info-circle info-circle"></i>
        <div class="padding-small">
            ðŸš§ This game is still under development! ðŸš§ Join the <a href="https://discord.gg/6xQsfqe2Nd">Energetica 
            Discord server</a> to stay updated with the latest news, report bugs, and engage with the community. 
            You can also contact me directly if you have questions (vsfelix@ethz.ch)<br>
            ðŸ†• Next server reset : <b>01.09.2024</b>, 12 PM
        </div>
    </div>

    <div class="bone padding margin">
        <h1 class="txt_center">Current weather conditions</h1>
        <div class="flex-row flex-space-around margin medium">
            <div class="flex-col flex-grow-1 padding weather_info_container">
                <div>Month: <b>{{ month }}</b></div>
                <div class="year-background margin-small">
                    <div class="current-date-dot" style="left: calc({{ ((engine.data['total_t'] + engine.data['delta_t']) % 25920)/25920 }} * 100%);"></div>
                </div>
            </div>
            <div class="flex-col flex-grow-1 padding weather_info_container">
                <div>Irradiance: <b>{{ irradiance | round | int }} W/mÂ²</b></div>
                <div class="year-background margin-small">
                    <div class="weather_level solar" style="width: calc({{ irradiance/875 }} * 100%);"></div>
                </div>
            </div>
            <div class="flex-col flex-grow-1 padding weather_info_container">
                <div>Wind speed: <b>{{ windspeed | round | int }} km/h</b></div>
                <div class="year-background margin-small">
                    <div class="weather_level wind" style="width: calc({{ windspeed/100 }} * 100%);"></div>
                </div>
            </div>
            <div class="flex-col flex-grow-1 padding weather_info_container">
                <div>River discharge: <b>{{ (discharge * 150) | round | int }} mÂ³/s</b></div>
                <div class="year-background margin-small">
                    <div class="weather_level water" style="width: calc({{ discharge }} * 100%);"></div>
                </div>
            </div>
        </div>
    </div>
    <div id="under_construction">
      {# Facilites under construction will show here #}
    </div>
    <div id="under_research">
      {# Technologies under research will show here #}
    </div>
    <div id="shipments">
      {# Shipments on their way will show here #}
    </div>
    {% if "network" not in user.advancements %}
    <div class="padding margin medium">
        <h2>Beginners guide</h2>
        <p>
            Welcome to Energetica!
        </p>
        <p>
            You begin your journey with <b>1 steam engine</b> and a small <b>industry</b>, generating revenues. You can monitor their 
            <a href='/production_overview/electricity'>power generation and consumption</a> as well as your 
            <a href='/production_overview/revenues'>revenues</a> under the <i>Production overview</i> tab in the 
            <span class="smartphone_hide">left</span><span class="display_hide">top</span> menu.
        </p>
        <p>
            The first thing you will probably want to do is to <b>expand your production</b> by investing in 
            <a href='/power_facilities'>Power facilities</a> and upgrading your industry on the <a href='/functional_facilities'>Functional facilities</a> page.
            You also have acess to <a href='/storage_facilities'>Storage facilities</a> to store energy. You will unlock 
            new technologies and more game mechanics as you progress.
        </p>
        <p>
            Engage with other players via the <i>Community</i> tab.
        </p>
        <p>
            If your are lost, click on the
            <img style="width: 0.8em; height: auto; padding:0 4px;" src="{{ url_for('static', filename='images/icons/wiki.png') }}" width="91" height="96" alt="Help page" />
            icon on the right side of the title, you will find explanations about the 
            content of the page. For detailed explanations on any game mechanics, consult the <a href='/wiki'>wiki</a>.
        </p>
        <p>
            Best of luck in your energy adventure!
        </p>
    </div>
    {% endif %}
{% endblock content %}
{% block additionnal_script %}
    <script src="{{ url_for('static', filename='progress_bar.js') }}"></script>
    <script>refresh_progressBar();</script>
{% endblock additionnal_script %}