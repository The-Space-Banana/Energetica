{% extends "base.jinja" %}
{% block title %}
  Storage facilities
{% endblock title %}
{% block content %}
  {% set data = all_data["assets"] %}
  <div class="flex-row huge title">
    Storage facilities
    <div class="pine info_icon_container"
         onclick="document.getElementById('info_popup').classList.remove('hidden');">{{ wikiImage() }}</div>
  </div>
  <div id="info_popup" class="popup hidden green">
    <div class="flex-row margin-small align-items-center">
      <div class="large txt_center flex-grow-1">Help : Storage facilities</div>
      <div onclick="document.getElementById('info_popup').classList.add('hidden');"
           class="cross pine margin-small"
           style="width:39px">Ã—</div>
    </div>
    <div class="txt_center margin medium">
      <p>On this page you will find all the facilities that can store energy.</p>
      <p>
        For more information about storage facilites, refer to the <a href="{{ url_for('views.wiki', _anchor='Storage_Facilities') }}">Storage facilities
        section in the wiki</a>.
      </p>
    </div>
  </div>
  <div id="under_construction">
    {# Facilites under construction will show here #}
  </div>
  {% for storage_facility in ["small_pumped_hydro", "compressed_air", "molten_salt", "large_pumped_hydro", "hydrogen_storage", "lithium_ion_batteries", "solid_state_batteries"] %}
    {% set facility_data = data[storage_facility] %}
    <div id="{{ facility_data.name }}"
         class="bone margin facility small construction_tile"
         onclick="show_construction('{{ facility_data.name }}', '{{ facility_data.name.locked }}');">
      {% if storage_facility == "small_pumped_hydro" %}
        {% set filename = "small_pumped_hydro.png" %}
      {% else %}
        {% set filename = storage_facility+'.jpg' %}
      {% endif %}
      <img class="img"
           src="{{ url_for('static', filename='images/storage_facilities/'+filename) }}"
           width="250"
           height="167"
           alt="{{ facility_data.name+' storage facility' }}">
      <div class="infotext padding">
        <strong class="large">{{ facility_data.name }}</strong>
        &ensp;
        <a class="white wikipedia_icon_container no_deco"
           href="{{ facility_data.wikipedia_link }}"
           target="_blank">
          <i class="fa fa-wikipedia-w" aria-hidden="true"></i>
        </a>
        &emsp;
        <span class="money_font">
          <script>display_money_long({{ facility_data.price }});</script>
        </span>
        <br>
        {{ facility_data.description }}
        <br>
      </div>
      <div class="infobox" id="requirements">
        {% if facility_data.locked %}
          <div>
            <strong>Unlock with :</strong>
            <br>
            <ul style="padding:0; margin:0;">
              {% for req in facility_data.requirements %}
                <li class="margin-small{% if req[2] %} req_fullfilled {% else %} requirement {% endif %}">
                  -
                  {{ data[req[0]]["name"] }} lvl {{ req[1] }}
                </li>
              {% endfor %}
            </ul>
          </div>
        {% endif %}
      </div>
      <div class="infobox" id="infotable">
        <table class="table tan_green">
          <tr>
            <td>Storage capacity</td>
            <td class="txt_center">
              <strong>
                <script>display_Wh({{ facility_data["storage capacity"] }});</script>
              </strong>
            </td>
          </tr>
          <tr>
            <td>Max generation</td>
            <td class="txt_center">
              <strong>
                <script>display_W({{ facility_data["power generation"] }});</script>
              </strong>
            </td>
          </tr>
          <tr>
            <td>Efficiency</td>
            <td class="txt_center">
              <strong>{{ (facility_data["efficiency"]*100)|int }}%</strong>
            </td>
          </tr>
          <tr>
            <td>Ramping speed</td>
            <td class="txt_center">
              <strong>
                <script>display_W({{ facility_data["ramping speed"] }});</script>/min
              </strong>
            </td>
          </tr>
        </table>
      </div>
      <div id="constructionContent" class="infobox hidden constructionContent">
        <div class="flex-col">
          <div class="txt_center margin-small" style="width:180px">
            Duration :
            <strong>
              <script>display_duration({{ facility_data["construction time"]}});</script>
            </strong>
            <br>
            Energy need :
            <strong>
              <script>display_W({{ facility_data["construction power"]}});</script>
            </strong>
            <br>
            Emmissions :
            <strong>
              <script>display_kg({{ facility_data["construction pollution"]}});</script> CO2
            </strong>
          </div>
          <b class="padding medium white button margin-small txt_center"
             onclick="start_construction('{{ storage_facility }}', 'Storage facilities');"
             style="width:160px">
            Start construction
          </b>
        </div>
      </div>
    </div>
  {% endfor %}
{% endblock content %}
{% block additionnal_script %}
  <script src="{{ url_for('static', filename='click_construction.js') }}"></script>
  <script>refresh_progressBar()</script>
{% endblock additionnal_script %}
